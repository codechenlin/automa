# Squid Proxy Configuration for Automaton
#
# Domain whitelist enforcement + request logging.
# The creator sees what the automaton tries to reach.

# Listen on port 3128
http_port 3128

# Only allow domains in the whitelist
acl whitelist dstdomain "/etc/squid/whitelist.txt"
http_access allow whitelist
http_access deny all

# HTTPS (CONNECT) tunneling — only for whitelisted domains
acl SSL_ports port 443
acl CONNECT method CONNECT
http_access allow CONNECT whitelist
http_access deny CONNECT

# Logging — every request logged for the creator to review
access_log /var/log/squid/access.log squid
cache_log /var/log/squid/cache.log

# Don't cache anything (we want fresh responses)
cache deny all

# Timeouts
connect_timeout 30 seconds
read_timeout 60 seconds

# Identification
visible_hostname automaton-proxy

# Deny manager access from containers
http_access deny manager
